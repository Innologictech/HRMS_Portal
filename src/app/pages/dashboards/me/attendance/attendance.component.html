<div class="container-fluid mt-3" style="cursor: pointer;">
  <!-- <div class="me-menu">
    <h4>Me</h4>

    <ul>
      <li><a routerLink="attendance" routerLinkActive="active">Attendance</a></li>
      <li><a routerLink="leaves" routerLinkActive="active">Employee Leaves</a></li>
      <li><a routerLink="performance" routerLinkActive="active">Performance</a></li>
      <li><a routerLink="expenses" routerLinkActive="active">Expenses</a></li>
      <li><a routerLink="apps" routerLinkActive="active">Apps</a></li>
      <li><a routerLink="assets" routerLinkActive="active">Assets</a></li>
      <li><a routerLink="myLetters'" routerLinkActive="active">My Letters</a></li>
      <li><a routerLink="Resignation" routerLinkActive="active">Resignation</a></li>
    </ul>
  </div>
</div> -->

<div class="attendance-page container-xl">




  <!-- ================= HEADER ================= -->
  <div class="row mb-4">
    <div class="col-auto" >
      <div class="title-group d-flex align-items-center gap-2">
        <h4 class="title mb-0">Attendance Stats</h4>
        <span class="info-icon">i</span>
      </div>
    </div>
  </div>

  <!-- ================= STATS (Me + My Team) ================= -->
  <div class="row g-4">

    <div class="col-lg-6 col-md-12">
      <div class="card stat-card h-100">
        <div class="card-header"><h4>Me</h4></div>

        <p class="value">{{ meStats.avg }}</p>
        <p class="label">{{ meStats.avgLabel }}</p>

        <p class="value-small">{{ meStats.arrival }}</p>
        <p class="label">{{ meStats.arrivalLabel }}</p> 

        <div class="mini-graph mt-2"> 
          <span></span><span></span><span></span><span></span><span></span>
        </div>
      </div>
    </div>

    <div class="col-lg-6 col-md-12">
      <div class="card stat-card h-100">
        <div class="card-header"><h4>My Team</h4></div>

        <p class="value">{{ teamStats.avg }}</p>
        <p class="label">{{ teamStats.avgLabel }}</p>

        <p class="value-small">{{ teamStats.arrival }}</p>
        <p class="label">{{ teamStats.arrivalLabel }}</p>

        <div class="mini-graph mt-2">
          <span></span><span></span><span></span><span></span><span></span>
        </div>
      </div>
    </div>

  </div>

  <!-- ================= TIMINGS + ACTIONS ================= -->
  <div class="row g-4 mt-3">

    <div class="col-lg-8 col-md-12">
      <div class="card timing-card h-100">

        <div class="title-group d-flex align-items-center gap-2">
          <h5 class="mb-0">Timings</h5>
          <span class="info-icon">i</span>
        </div>

        <div class="week-days mt-2">
          <button *ngFor="let d of weekDays; let i = index"
                  class="day-pill"
                  [class.active]="i === activeWeekIndex">
            {{ d }}
          </button>
        </div>

        <div class="today mt-3">
          <p class="today-label">{{ todayTiming }}</p>

          <div class="bar">
            <div class="progress"></div>
          </div>

          <p class="duration">{{ duration }}</p>
        </div>

      </div>
    </div>

    <div class="col-lg-4 col-md-12">
      <div class="card action-card h-100">

        <div class="title-group d-flex align-items-center gap-2">
          <h5 class="mb-0">Actions</h5>
          <span class="info-icon">i</span>
        </div>

        <p class="action-time">{{ clockTime }}</p>
        <p class="last-login">{{ lastLogin }}</p>

        <div class="action-links mt-3">
          <a href="#">Partial Day Request</a>
          <a href="#">Attendance Policy</a>
        </div>

      </div>
    </div>

  </div>

  <!-- ================= LOGS & REQUESTS ================= -->
  <div class="row mt-4">
    <div class="col-12">

      <div class="title-group d-flex align-items-center gap-2 mb-3">
        <h5 class="mb-0">Logs & Requests</h5>
        <span class="info-icon">i</span>
      </div>

      <!-- Tabs -->
      <div class="log-tabs mb-3">
        <button [class.active]="activeLogTab === 'log'" (click)="setActiveTab('log')">Attendance Log</button>
        <button [class.active]="activeLogTab === 'calendar'" (click)="setActiveTab('calendar')">Calendar</button>
        <button [class.active]="activeLogTab === 'requests'" (click)="setActiveTab('requests')">Attendance Requests</button>
      </div>

      <!-- Log Placeholder -->
      <div *ngIf="activeLogTab === 'log'" class="placeholder">
        <h6>Attendance log view will come here</h6>
      </div>

      <!-- Calendar -->
      <div *ngIf="activeLogTab === 'calendar'" class="calendar-wrapper">
        
        <div class="calendar-nav">
          <button class="nav-btn" (click)="prevMonth()">‹</button>
          <div class="month-label">{{ calendarMonthName }} {{ calendarYear }}</div>
          <button class="nav-btn" (click)="nextMonth()">›</button>
        </div>

        <table class="calendar-table w-100">
          <thead>
            <tr>
              <th *ngFor="let h of calendarDaysHeader">{{ h }}</th>
            </tr>
          </thead>

          <tbody>
            <tr *ngFor="let week of calendarWeeks">
              <td *ngFor="let day of week" class="day-cell">
                <div class="cell">

                  <div *ngIf="day.isToday" class="triangle"></div>
                  <div class="date" *ngIf="day.date">{{ day.date }}</div>   

                  <div class="spacer"></div>

                  <div class="timing" *ngIf="day.timing">{{ day.timing }}</div>
                  <div class="off" *ngIf="day.isOff">OFF</div>

                </div>
              </td>
            </tr>
          </tbody>
        </table>

      </div>

      <!-- Requests table -->
      <div *ngIf="activeLogTab === 'requests'">

        <table class="log-table w-100">
          <thead>
            <tr>
              <th>Date</th>
              <th>Note</th>
              <th>Status</th>
              <th>Last Action By</th>
              <th>Next Approver</th>
              <th></th>
            </tr>
          </thead>

          <tbody>
            <tr *ngFor="let item of pagedRequests">
              <td>{{ item.date }}</td>
              <td>{{ item.note }}</td>
              <td class="status" [class.pending]="item.status === 'Pending'">{{ item.status }}</td>
              <td>{{ item.actionBy }}</td>
              <td>{{ item.next }}</td>
              <td><button class="action-btn">⋮</button></td>
            </tr>
          </tbody>
        </table>

        <div class="pagination">
          <span>Page {{ currentPage }} of {{ totalPages }}</span>
          <button (click)="goToPage(currentPage - 1)" [disabled]="currentPage === 1">‹</button>
          <button (click)="goToPage(currentPage + 1)" [disabled]="currentPage === totalPages">›</button>
        </div>

      </div>

    </div>
  </div>

  <!-- ================= PARTIAL DAY ================= -->
  <div class="row mt-4 mb-4">
    <div class="col-12">
      <div class="card partial-card">
        <div class="title-group d-flex align-items-center gap-2 mb-2">
          <h5 class="mb-0">Partial Day Requests</h5>
          <span class="info-icon">i</span>
        </div>
        <div class="empty-row">No Partial Day Requests Available.</div>
      </div>
    </div>
  </div>

</div>
